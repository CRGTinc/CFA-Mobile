/*3111bf0faf0b556b55ab802aecc7495269e3ec62*/Ext.define("Deft.ioc.DependencyProvider",{config:{identifier:null,className:null,parameters:null,fn:null,value:null,singleton:!0,eager:!1},constructor:function(b){this.initConfig(b);b.value!=null&&b.value.constructor===Object&&this.setValue(b.value);this.getEager()&&(this.getValue()!=null&&Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': a 'value' cannot be created eagerly."),this.getSingleton()||Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': only singletons can be created eagerly."));this.getSingleton()||this.getValue()!=null&&Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': a 'value' can only be configured as a singleton.");return this},resolve:function(d){var c;Ext.log("Resolving '"+this.getIdentifier()+"'.");if(this.getValue()!=null){return this.getValue()}c=null;this.getFn()!=null?(Ext.log("Executing factory function."),c=this.fn(d)):this.getClassName()!=null?(Ext.log("Creating instance of '"+this.getClassName()+"'."),d=this.getParameters()!=null?[this.getClassName()].concat(this.getParameters()):[this.getClassName()],c=Ext.create.apply(this,d)):Ext.Error.raise("Error while configuring rule for '"+this.getIdentifier()+"': no 'value', 'fn', or 'className' was specified.");this.getSingleton()&&this.setValue(c);return c}});Ext.define("Deft.ioc.Injector",{alternateClassName:["Deft.Injector"],requires:["Deft.ioc.DependencyProvider"],singleton:!0,constructor:function(){this.providers={};return this},configure:function(b){Ext.log("Configuring injector.");Ext.Object.each(b,function(e,g){var f;Ext.log("Configuring dependency provider for '"+e+"'.");f=Ext.isString(g)?Ext.create("Deft.ioc.DependencyProvider",{identifier:e,className:g}):Ext.create("Deft.ioc.DependencyProvider",Ext.apply({identifier:e},g));this.providers[e]=f},this);Ext.Object.each(this.providers,function(d,e){e.getEager()&&(Ext.log("Eagerly creating '"+e.getIdentifier()+"'."),e.resolve())},this)},canResolve:function(b){return this.providers[b]!=null},resolve:function(e,d){var f;f=this.providers[e];return f!=null?f.resolve(d):Ext.Error.raise("Error while resolving value to inject: no dependency provider found for '"+e+"'.")},inject:function(f,e){var l,k,j,g;l={};Ext.isString(f)&&(f=[f]);Ext.Object.each(f,function(h,b){var a,c;c=Ext.isArray(f)?b:h;a=this.resolve(b,e);e.config.hasOwnProperty(c)?(Ext.log("Injecting '"+b+"' into 'config."+c+"'."),l[c]=a):(Ext.log("Injecting '"+b+"' into '"+c+"'."),e[c]=a)},this);if(e.$configInited){for(k in l){g=l[k],j="set"+Ext.String.capitalize(k),e[j].call(e,g)}}else{e.config=Ext.Object.merge({},e.config||{},l)}return e}});Ext.define("Deft.mixin.Injectable",{requires:["Deft.ioc.Injector"],onClassMixedIn:function(b){b.prototype.constructor=Ext.Function.createInterceptor(b.prototype.constructor,function(){return Deft.Injector.inject(this.inject,this)})}});